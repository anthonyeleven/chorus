# Chorus WEB UI doc

## Intro

### What is S3 storage?
S3 is an object storage originally developed by AWS.

It provides HTTP api to upload/download `objects` (files).

Objects are stored in `buckets`.

Shortlist of S3 API features:
- get/create/delete/list `bucket`
- get/create/delete/list `object` in a `bucket`

### What is chorus?

Chorus is a data replication software designed for multiple S3 storage systems. It works by:

1. Users inputting storage credentials into the Chorus configuration.
2. One storage is selected as the `main` while others become `followers`.
3. Once configured and started, Chorus's S3 API can be used instead of the `main` storage's API.
4. Chorus proxies requests to the `main` storage and asynchronously replicates the data to `follower` storages.

Chorus is structured around two main web services: `Chorus Proxy` and `Chorus Worker`.

The `Chorus Proxy` operates as an intermediary for the `main` S3 storage, which also means Chorus provides an [S3 API](./s3-api.md). 
Using Chorus Proxy involves:

1. Sending a request to the Chorus S3 API.
2. The `Chorus Proxy` redirects the request to the `main` storage.
3. For write requests (`{POST}`, `{PUT}`, `{DELETE}`), the proxy creates a task to copy changes from the `main` to `follower` storages.
4. The `Chorus Worker` retrieves the task and syncs changes from the `main` to the `follower`.

All changes generated by the proxy are stored in an `event` queue.

Chorus also has a `migration` feature for cases where the `main` S3 storage isn't initially empty. 
This allows Chorus to transfer existing data to `followers` in the background. 
The `migration` process involves:

1. Listing all buckets in the `main`.
2. Listing all objects for all listed buckets in the `main`.
3. Creating a task for each object to sync it from the `main` to the `follower`.
4. The worker processes tasks in the background, copying or updating files as needed.

All migration tasks are stored in a separate `migration` queue.

